<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of AnalImageMap</title>
  <meta name="keywords" content="AnalImageMap">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html XeX --><!-- ../menu.html AnalysisFunctions --><!-- menu.html Analysis -->
<h1>AnalImageMap
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../XeX/UtilityFunctions/gettingAndsettingParameters/discretizeXes.html" class="code" title="">discretizeXes</a>	</li><li><a href="../../../XeX/UtilityFunctions/main/CountSpikes.html" class="code" title="function [countsmat]=CountSpikes(Trials,indices,alignTimes,xVec,unitCode,AnalogCorrect)">CountSpikes</a>	returns total spike counts for each Trial in a matrix</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../XeX/OutsideXex/doAnalysis.html" class="code" title="">doAnalysis</a>	This is a script so that it can be run in any format anywhere</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 FilterHere=1;
0002 TotalFilter=1&amp;CurrentFilterVector;
0003 
0004 <a href="../../../XeX/UtilityFunctions/gettingAndsettingParameters/discretizeXes.html" class="code" title="">discretizeXes</a>;
0005 eval([<span class="string">'UniqueX=unique('</span> CurrentXAxisVariableStr <span class="string">'(~isnan('</span> CurrentXAxisVariableStr <span class="string">')));'</span>]);
0006 eval([<span class="string">'UniqueY=unique('</span> CurrentX1AxisVariableStr <span class="string">'(~isnan('</span> CurrentX1AxisVariableStr <span class="string">')));'</span>]);
0007 SpikeCount=nan*ones(length(UniqueY),length(UniqueX));
0008 OverNumTrials=SpikeCount;
0009 SigMat=SpikeCount;
0010 SpikeRate=SpikeCount;
0011 SpikeRateAve=SpikeCount;
0012 
0013 <span class="keyword">for</span> ind=1:length(UniqueX)
0014     <span class="keyword">for</span> ind1=1:length(UniqueY)
0015         eval([<span class="string">'FindResult=find('</span> CurrentXAxisVariableStr <span class="string">'==UniqueX(ind) &amp; '</span> CurrentX1AxisVariableStr <span class="string">'== UniqueY(ind1) &amp;TotalFilter);'</span>]);
0016         eval([<span class="string">'SpikeMat=CountSpikes(Trials,RFTrialIndex(FindResult),'</span> CurrentAlignString <span class="string">'(FindResult),TimeWindowVector,CurrentUnitNumber, CurrentAnalogCorrect);'</span>]); <span class="comment">%keyboard;</span>
0017        SpikeRate(ind1,ind)=nanmean(SpikeMat)*1000/(TimeWindowVector(2)-TimeWindowVector(1));
0018         SpikeCount(ind1,ind)=nansum(SpikeMat); <span class="comment">%total number of spikes in window across trials</span>
0019         TempCount=nan*SpikeMat;
0020         TempCount(~isnan(SpikeMat))=1;
0021         OverNumTrials(ind1,ind)=nansum(TempCount); <span class="comment">%trick to find number of ~isnans</span>
0022         <span class="keyword">if</span> OverNumTrials(ind1,ind)==0, SpikeRate(ind1,ind)=NaN; SpikeCount(ind1,ind)=NaN;<span class="keyword">end</span>
0023 <span class="keyword">end</span>
0024 <span class="keyword">end</span>
0025 
0026 
0027 <span class="keyword">if</span> exist(<span class="string">'BFR'</span>,<span class="string">'var'</span>),BaseRate=BFR; <span class="keyword">else</span> BaseRate=0; fprintf(<span class="string">'%s\n'</span>,<span class="string">'USING DEFAULT BASE RATE OF ZERO. WATCH OUT'</span>);<span class="keyword">end</span>
0028 
0029 <span class="comment">% if CurrentPlotSig==1,</span>
0030     
0031 <span class="comment">%    fprintf('P = %2.6f\n',CurrentPValue);</span>
0032 <span class="comment">% keyboard;</span>
0033 
0034     ExpNumSpikes= BaseRate * OverNumTrials * ( TimeWindowVector(2) - TimeWindowVector(1) ) / 1000;
0035     CDFValue = poisscdf(SpikeCount,ExpNumSpikes);
0036     LowSig = CDFValue &lt; CurrentPValue;
0037     HighSig= CDFValue &gt; (1-CurrentPValue);
0038     SigMat(LowSig==1&amp;~isnan(SpikeCount))=1;
0039     SigMat(HighSig==1&amp;~isnan(SpikeCount))=2;
0040     
0041 <span class="comment">%     NumCols=length(UniqueX);</span>
0042 <span class="comment">% keyboard;</span>
0043     YMat=repmat(UniqueY',1,length(UniqueX));
0044     XMat=repmat(UniqueX,length(UniqueY),1);
0045 <span class="comment">%     end</span></pre></div>
<hr><address>Generated on Wed 13-Dec-2006 00:06:54 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>