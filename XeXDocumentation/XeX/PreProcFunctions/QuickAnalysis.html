<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of QuickAnalysis</title>
  <meta name="keywords" content="QuickAnalysis">
  <meta name="description" content="This function analyzes trials for a quick analysis">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html XeX --><!-- menu.html PreProcFunctions -->
<h1>QuickAnalysis
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This function analyzes trials for a quick analysis</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function CurrentVariables=QuickAnalysis(Trials,klugestring,UseAx,SacOpts) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">    This function analyzes trials for a quick analysis
    CurrentVariables=QuickAnalysis(Trials,klugestring,UseAx,SacOpts)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../XeX/UtilityFunctions/assorted/attachvars.html" class="code" title="">attachvars</a>	This script evaluates what variables are present in the calling</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 
0002 <a name="_sub0" href="#_subfunctions" class="code">function CurrentVariables=QuickAnalysis(Trials,klugestring,UseAx,SacOpts)</a>
0003 
0004 <span class="comment">%    This function analyzes trials for a quick analysis</span>
0005 <span class="comment">%    CurrentVariables=QuickAnalysis(Trials,klugestring,UseAx,SacOpts)</span>
0006 
0007 
0008 MyVariableList={<span class="string">'numTrials'</span>,<span class="string">'numGoodTrials'</span>,<span class="string">'numPhotoBad'</span>,<span class="string">'unitNumbers'</span>,<span class="string">'FPx'</span>,<span class="string">'FPy'</span>,<span class="string">'RFx'</span>,<span class="string">'RFy'</span>};
0009 MyResponseVariableList={<span class="string">'GoodTrial'</span>};
0010 
0011 numTrials=length(Trials);
0012 numGoodTrials=0;
0013 numPhotoBad=0;
0014 
0015 unitNumbers=[];
0016 
0017 FPx=nan*ones(1,numTrials); FPy=FPx;
0018 
0019 RFx=repmat(FPx,1,10);
0020 RFy=RFx;
0021 RFIndex=1;
0022 
0023 <span class="keyword">for</span> ind=1:length(Trials)
0024     CurrentEvents=Trials(ind).Events;
0025     CurrentCodes=double([CurrentEvents.Code]);
0026     CurrentTimes=double([CurrentEvents.Time]);
0027     
0028     <span class="keyword">if</span> ~isempty(find(CurrentCodes==1012)) numGoodTrials=numGoodTrials+1;<span class="keyword">end</span>
0029     <span class="keyword">if</span> ~isempty(find(CurrentCodes==1092)) numPhotoBad=numPhotoBad+1;<span class="keyword">end</span>
0030     
0031         
0032     uni=[Trials(ind).Units];
0033     <span class="keyword">if</span> ~isempty(uni)
0034         curcodes=[uni.Code];
0035         unitNumbers=union(unitNumbers,curcodes);
0036     <span class="keyword">end</span>
0037  
0038     is_rf=find(CurrentCodes==1007);
0039 
0040     <span class="keyword">if</span> ~isempty(is_rf), 
0041         
0042          <span class="keyword">for</span> TempVar=1:length(is_rf) 
0043             
0044           RFOnTime=CurrentTimes(is_rf(TempVar));
0045           <span class="comment">%assuming max of 100 ms duration &amp; min of 100 ms ISI</span>
0046 
0047                  FindResult=find(abs(CurrentTimes-RFOnTime)&lt;5 &amp; CurrentCodes&lt;=6850&amp;CurrentCodes&gt;=5650);
0048 
0049 <span class="comment">%           FindResult=find(CurrentCodes&gt;6250 &amp; CurrentCodes&lt;6750 &amp; (CurrentTimes-RFOnTime)==0);</span>
0050           <span class="keyword">if</span> length(FindResult)&gt;=2, RFx(RFIndex)=(CurrentCodes(FindResult(1))-6000)/10; RFy(RFIndex)=(CurrentCodes(FindResult(2))-6500)/10;          <span class="keyword">end</span>
0051 <span class="comment">%           FindResult=find(CurrentCodes&lt;6250 &amp; CurrentCodes&gt;5750 &amp; (CurrentTimes-RFOnTime)==0 );</span>
0052 <span class="comment">%           if length(FindResult)~=0, end</span>
0053           RFIndex=RFIndex+1;
0054 <span class="comment">%              if RFIndex==2, keyboard;end</span>
0055          <span class="keyword">end</span>
0056 
0057     <span class="keyword">end</span>
0058     
0059     
0060     
0061     is_fp=find(CurrentCodes==1003);
0062     <span class="keyword">if</span> ~isempty(is_fp)
0063         XCode=find(CurrentCodes&gt;=10700);
0064         <span class="keyword">if</span> length(XCode)&gt;=4   <span class="comment">%have changes this to 4. remember that some earlier codes have only 3, as one drop was missing (2nd i think). could shift 3 and 4 to 2 and 3 in that case, but havent done that yet ! WATCH OUT</span>
0065             FPx(ind)=(CurrentCodes(XCode(3))-11000)/10;
0066             FPy(ind)=(CurrentCodes(XCode(4))-11000)/10;
0067         <span class="keyword">end</span>
0068     <span class="keyword">end</span>
0069 
0070 <span class="comment">%     if(FPx(ind)~=0), keyboard;end</span>
0071 
0072 <span class="keyword">end</span>
0073 
0074 summaryString=[sprintf(<span class="string">'%s\n'</span>,<span class="string">'***********Analysis****************'</span>)];
0075 summaryString=[summaryString sprintf(<span class="string">'%s\t%d\n'</span>,<span class="string">'Number of Trials='</span>,numTrials)];
0076 summaryString=[summaryString sprintf(<span class="string">'%s\t%d\n'</span>,<span class="string">'Number of Good Trials='</span>,numGoodTrials)];
0077 summaryString=[summaryString sprintf(<span class="string">'%s\t%d\n'</span>,<span class="string">'Number of Photobads='</span>,numPhotoBad)];
0078 summaryString=[summaryString sprintf(<span class="string">'%s\n'</span>,[<span class="string">'Unique Unit Numbers are    '</span> num2str(unique(unitNumbers))])];
0079 <span class="keyword">if</span> exist(<span class="string">'UseAx'</span>,<span class="string">'var'</span>)&amp;&amp;UseAx~=0, axes(UseAx); 
0080     plot(RFx,RFy,<span class="string">'bo'</span>);
0081 <span class="keyword">end</span>
0082 
0083 FPmat=[FPx;FPy]';
0084 FPmat=FPmat(~isnan(FPx),:);
0085 FPmat=unique(FPmat,<span class="string">'rows'</span>);
0086 <span class="keyword">if</span> length(FPmat)&lt;10
0087     summaryString=[summaryString sprintf(<span class="string">'%s\n'</span>,<span class="string">'FPx     FPy'</span>)];
0088     <span class="keyword">for</span> ii=1:size(FPmat,1)
0089         summaryString=[summaryString sprintf(<span class="string">'%s\n'</span>,num2str([FPmat(ii,1) FPmat(ii,2)],<span class="string">'%6.2f'</span>))];
0090     <span class="keyword">end</span>
0091     summaryString=[summaryString sprintf(<span class="string">'%s\n'</span>,<span class="string">'********'</span>)];
0092 <span class="keyword">end</span>
0093 
0094 
0095 RFmat=[RFx;RFy]';
0096 RFmat=unique(RFmat,<span class="string">'rows'</span>);
0097 <span class="keyword">if</span> length(RFmat)&lt;10
0098     summaryString=[summaryString sprintf(<span class="string">'%s\n'</span>,<span class="string">'RFx     RFy'</span>)];
0099     <span class="keyword">for</span> ii=1:size(RFmat,1)
0100         summaryString=[summaryString sprintf(<span class="string">'%s\n'</span>,num2str([RFmat(ii,1) RFmat(ii,2)],<span class="string">'%6.2f'</span>))];
0101     <span class="keyword">end</span>
0102 <span class="keyword">end</span>
0103 
0104 
0105 fprintf(<span class="string">'%s\n'</span>,summaryString);
0106 <a href="../../XeX/UtilityFunctions/assorted/attachvars.html" class="code" title="">attachvars</a>;</pre></div>
<hr><address>Generated on Wed 13-Dec-2006 00:06:54 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>